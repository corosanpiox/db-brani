<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invia Dati a Google Sheets</title>
</head>
<body>
    <h1>Brani coro</h1>
    <h3>Ricerca per:</h3>
    <form id="dataForm">
        <font size="4">
        <label for="messa">Momento messa:&nbsp&nbsp</label>
        <font size="5">
        <select name="messa" id="messa">
            <option value="none">&nbsp-</option>
            <option value="Inizio">Inizio</option>
            <option value="Gloria">Gloria</option>
            <option value="Salmo">Salmo</option>
            <option value="Vangelo">Vangelo</option>
            <option value="Offertorio">Offertorio</option>
            <option value="Santo">Santo</option>
            <option value="Pace">Pace</option>
            <option value="Comunione">Comunione</option>
            <option value="Fine">Fine</option>
        </select>
        <font size="4">
        <br><br>
        
        <label for="keyword">Parola chiave:&nbsp&nbsp</label>
        <input type="text" id="keyword" name="keyword">
        <br><br>

        <h3>Filtri</h3>
        <label for="momentoandkeyword">Momento & parola chiave</label>
        <input type="checkbox" id="momentoandkeyword" name="momentoandkeyword">
        <br>
            
        <label for="messespeciali">Escludi messe "speciali"</label>
        <input type="checkbox" id="messespeciali" name="messespeciali">
        <br>
        
        <label for="branifacili">Solo brani facili/conosciuti</label>
        <input type="checkbox" id="branifacili" name="branifacili">
        <br><br>

        <button type="submit" style="height:40px; width:100px">Aggiorna</button>
    </form>

    <p id="response"></p>

    <script>
        document.getElementById('dataForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const momentomessa = document.getElementById('messa').value;
            const keyword = document.getElementById('keyword').value;
            const momentoandkeyword = document.getElementById('momentoandkeyword').checked;
            const messespeciali = document.getElementById('messespeciali').checked;
            const branifacili = document.getElementById('branifacili').checked;
            
            const url = 'https://script.google.com/macros/s/AKfycbyy05_Y631jdjB1qMRXRXJj5HTC-BTzf3Aya6l8BTTFBS-7FUHwjlA7aLBR9O8dfTmo/exec';  // Inserisci l'URL del tuo Google Apps Script qui

            // Crea un oggetto formData con i dati del modulo
            const formData = new URLSearchParams();
            formData.append('momentomessa', momentomessa);
            formData.append('keyword', keyword);
            formData.append('momentoandkeyword', momentoandkeyword);
            formData.append('messespeciali', messespeciali);
            formData.append('branifacili', branifacili);

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.text();
                document.getElementById('response').textContent = result;
            } catch (error) {
                console.error('Errore:', error);
                document.getElementById('response').textContent = 'Errore nell\'invio dei dati.';
            }
        });
    </script>
</body>
</html>
