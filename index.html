<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invia Dati a Google Sheets</title>
</head>
<body>
    <h1>Brani coro</h1>
    <h3>Ricerca per:</h3>
    <form id="dataForm">
        <font size="4">
        <label for="momento-messa">Momento messa:&nbsp&nbsp</label>
        <font size="5">
        <select name="messa" id="messa">
            <option value="none">&nbsp-</option>
            <option value="Inizio">Inizio</option>
            <option value="Gloria">Gloria</option>
            <option value="Salmo">Salmo</option>
            <option value="Vangelo">Vangelo</option>
            <option value="Offertorio">Offertorio</option>
            <option value="Santo">Santo</option>
            <option value="Pace">Pace</option>
            <option value="Comunione">Comunione</option>
            <option value="Fine">Fine</option>
        </select>
        <font size="4">
        <br><br>
        
        <label for="nome">Parola chiave:&nbsp&nbsp</label>
        <input type="text" id="keyword" name="keyword">
        <br><br>

        <h3>Filtri</h3>
        <label for="momentoandkeyword">Momento & parola chiave</label>
        <input type="checkbox" id="momentoandkeyword" name="momentoandkeyword" value="momentoandkeyword">
        <br>
            
        <label for="messe_speciali">Escludi messe "speciali"</label>
        <input type="checkbox" id="messe_speciali" name="messe_speciali" value="messe_speciali">
        <br>
        
        <label for="brani_facili">Solo brani facili/conosciuti</label>
        <input type="checkbox" id="brani_facili" name="brani_facili" value="brani_facili">
        <br><br>

        <button type="submit" style="height:40px; width:100px" style="font-size:5vw;">Aggiorna</button>
    </form>

    <p id="response"></p>

    <script>
        document.getElementById('dataForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const nome = document.getElementById('nome').value;
            const email = document.getElementById('email').value;
            const url = 'https://script.google.com/macros/s/AKfycbx_WTW60k1t22KDHE6S1biLggNAs18-ikYwwwHo_843yN38v8cFmXAk1-ZvdmSkw5iy/exec';  // Inserisci l'URL del tuo Google Apps Script qui

            // Crea un oggetto formData con i dati del modulo
            const formData = new URLSearchParams();
            formData.append('nome', nome);
            formData.append('email', email);

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.text();
                document.getElementById('response').textContent = result;
            } catch (error) {
                console.error('Errore:', error);
                document.getElementById('response').textContent = 'Errore nell\'invio dei dati.';
            }
        });
    </script>
</body>
</html>
